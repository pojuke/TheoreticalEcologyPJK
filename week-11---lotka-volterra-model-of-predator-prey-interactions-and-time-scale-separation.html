<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Week 11 - Lotka-Volterra model of predator-prey interactions and time-scale separation | Introduction to Theoretical Ecology</title>
  <meta name="description" content="This is the course website for Introduction to Theoretical Ecology 2024 Fall at National Taiwan University." />
  <meta name="generator" content="bookdown 0.39 and GitBook 2.6.7" />

  <meta property="og:title" content="Week 11 - Lotka-Volterra model of predator-prey interactions and time-scale separation | Introduction to Theoretical Ecology" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://pojuke.github.io/TheoreticalEcologyPJK/bifurcation.gif" />
  <meta property="og:description" content="This is the course website for Introduction to Theoretical Ecology 2024 Fall at National Taiwan University." />
  <meta name="github-repo" content="pojuke/TheoreticalEcologyPJK" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Week 11 - Lotka-Volterra model of predator-prey interactions and time-scale separation | Introduction to Theoretical Ecology" />
  
  <meta name="twitter:description" content="This is the course website for Introduction to Theoretical Ecology 2024 Fall at National Taiwan University." />
  <meta name="twitter:image" content="https://pojuke.github.io/TheoreticalEcologyPJK/bifurcation.gif" />

<meta name="author" content="Instructor: Po-Ju Ke ~~~~~ Teaching Assistant: Hsiang-Chih Lo" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="week-10---lotka-volterra-competition-model---visualization-of-dynamics-with-complex-eigenvalues.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Introduction to Theoretical Ecology</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Course information</a></li>
<li class="chapter" data-level="" data-path="syllabus.html"><a href="syllabus.html"><i class="fa fa-check"></i>Syllabus</a></li>
<li class="chapter" data-level="" data-path="week-2---exponential-population-growth.html"><a href="week-2---exponential-population-growth.html"><i class="fa fa-check"></i>Week 2 - Exponential population growth</a></li>
<li class="chapter" data-level="" data-path="week-3---national-holiday-no-class.html"><a href="week-3---national-holiday-no-class.html"><i class="fa fa-check"></i>Week 3 - National holiday (No class)</a></li>
<li class="chapter" data-level="" data-path="week-4---logistic-population-growth-and-stability-analysis.html"><a href="week-4---logistic-population-growth-and-stability-analysis.html"><i class="fa fa-check"></i>Week 4 - Logistic population growth and stability analysis</a></li>
<li class="chapter" data-level="" data-path="week-5---metapopulations-and-patch-occupancy-models.html"><a href="week-5---metapopulations-and-patch-occupancy-models.html"><i class="fa fa-check"></i>Week 5 - Metapopulations and patch occupancy models</a></li>
<li class="chapter" data-level="" data-path="week-6---harvesting-and-bifurcation.html"><a href="week-6---harvesting-and-bifurcation.html"><i class="fa fa-check"></i>Week 6 - Harvesting and bifurcation</a></li>
<li class="chapter" data-level="" data-path="week-7---age-structure-population-model.html"><a href="week-7---age-structure-population-model.html"><i class="fa fa-check"></i>Week 7 - Age-structure population model</a></li>
<li class="chapter" data-level="" data-path="week-8---lotka-volterra-competition-model---population-dynamics.html"><a href="week-8---lotka-volterra-competition-model---population-dynamics.html"><i class="fa fa-check"></i>Week 8 - Lotka-Volterra competition model - Population dynamics</a></li>
<li class="chapter" data-level="" data-path="week-9---midterm.html"><a href="week-9---midterm.html"><i class="fa fa-check"></i>Week 9 - Midterm</a></li>
<li class="chapter" data-level="" data-path="week-10---lotka-volterra-competition-model---visualization-of-dynamics-with-complex-eigenvalues.html"><a href="week-10---lotka-volterra-competition-model---visualization-of-dynamics-with-complex-eigenvalues.html"><i class="fa fa-check"></i>Week 10 - Lotka-Volterra competition model - Visualization of dynamics with complex eigenvalues</a></li>
<li class="chapter" data-level="" data-path="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html"><i class="fa fa-check"></i>Week 11 - Lotka-Volterra model of predator-prey interactions and time-scale separation</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to Theoretical Ecology</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation" class="section level1 unnumbered hasAnchor">
<h1>Week 11 - Lotka-Volterra model of predator-prey interactions and time-scale separation<a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><strong>Part 1: analyzing the classic Lotka-Volterra predator-prey model</strong></p>
<p>In this lab, we are going to analyze the classic Lotka-Volterra predator-prey model:</p>
<p><span class="math display">\[\begin{align*}
\frac {dN}{dt} &amp;= rN-aNP\\
\frac {dP}{dt} &amp;= eaNP-dP
\end{align*}\]</span></p>
<p>The non-trivial equilibrium of this system is <span class="math inline">\(E_c = (N = \frac{d}{ea}, P = \frac{r}{a})\)</span>.</p>
<p>We simulate the model using the following parameter set (<span class="math inline">\(N_0\)</span> = 10, <span class="math inline">\(P_0\)</span> = 2, <span class="math inline">\(r\)</span> = 1.0, <span class="math inline">\(a\)</span> = 0.1, <span class="math inline">\(e\)</span> = 0.8, <span class="math inline">\(d\)</span> = 0.5) and plot the population trajectories of predator and prey over time. We also show their population dynamics in the state-space diagram.</p>
<p>What will happen if you add a perturbation to the system (i.e., change the initial conditions)? Try out different values of <span class="math inline">\(N_0\)</span> and <span class="math inline">\(P_0\)</span> and visualize the differences in the state-space diagram by yourselve.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb80-1" tabindex="-1"></a><span class="fu">library</span>(deSolve)</span>
<span id="cb80-2"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb80-2" tabindex="-1"></a><span class="do">### Model specification</span></span>
<span id="cb80-3"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb80-3" tabindex="-1"></a>LV_predation_model <span class="ot">&lt;-</span> <span class="cf">function</span>(times, state, parms) {</span>
<span id="cb80-4"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb80-4" tabindex="-1"></a>  <span class="fu">with</span>(<span class="fu">as.list</span>(<span class="fu">c</span>(state, parms)), {</span>
<span id="cb80-5"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb80-5" tabindex="-1"></a>    dN_dt <span class="ot">=</span> r<span class="sc">*</span>N <span class="sc">-</span> a<span class="sc">*</span>N<span class="sc">*</span>P</span>
<span id="cb80-6"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb80-6" tabindex="-1"></a>    dP_dt <span class="ot">=</span> e<span class="sc">*</span>a<span class="sc">*</span>N<span class="sc">*</span>P <span class="sc">-</span> d<span class="sc">*</span>P</span>
<span id="cb80-7"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb80-7" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="fu">c</span>(dN_dt, dP_dt)))</span>
<span id="cb80-8"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb80-8" tabindex="-1"></a>  })</span>
<span id="cb80-9"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb80-9" tabindex="-1"></a>}</span>
<span id="cb80-10"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb80-10" tabindex="-1"></a></span>
<span id="cb80-11"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb80-11" tabindex="-1"></a><span class="do">### Model parameters</span></span>
<span id="cb80-12"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb80-12" tabindex="-1"></a>times <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb80-13"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb80-13" tabindex="-1"></a>state <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">N =</span> <span class="dv">10</span>, <span class="at">P =</span> <span class="dv">2</span>)</span>
<span id="cb80-14"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb80-14" tabindex="-1"></a>parms <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">r =</span> <span class="fl">1.0</span>, <span class="at">a =</span> <span class="fl">0.1</span>, <span class="at">e =</span> <span class="fl">0.8</span>, <span class="at">d =</span> <span class="fl">0.5</span>)</span>
<span id="cb80-15"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb80-15" tabindex="-1"></a></span>
<span id="cb80-16"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb80-16" tabindex="-1"></a><span class="do">### Model application</span></span>
<span id="cb80-17"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb80-17" tabindex="-1"></a>pop_size <span class="ot">&lt;-</span> <span class="fu">ode</span>(<span class="at">func =</span> LV_predation_model, <span class="at">times =</span> times, <span class="at">y =</span> state, <span class="at">parms =</span> parms)</span>
<span id="cb80-18"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb80-18" tabindex="-1"></a></span>
<span id="cb80-19"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb80-19" tabindex="-1"></a><span class="do">### Visualization -- population dynamics</span></span>
<span id="cb80-20"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb80-20" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(times)), <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(pop_size[, <span class="fu">c</span>(<span class="st">&quot;N&quot;</span>, <span class="st">&quot;P&quot;</span>)] <span class="sc">+</span> <span class="dv">10</span>)), <span class="at">type =</span> <span class="st">&quot;n&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;time&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;population size&quot;</span>)</span>
<span id="cb80-21"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb80-21" tabindex="-1"></a><span class="fu">lines</span>(N <span class="sc">~</span> time, <span class="at">data =</span> pop_size, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>) <span class="co"># dynamics of N</span></span>
<span id="cb80-22"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb80-22" tabindex="-1"></a><span class="fu">lines</span>(P <span class="sc">~</span> time, <span class="at">data =</span> pop_size, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>) <span class="co"># dynamics of P</span></span>
<span id="cb80-23"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb80-23" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> parms[<span class="dv">4</span>]<span class="sc">/</span>(parms[<span class="dv">3</span>] <span class="sc">*</span> parms[<span class="dv">2</span>]), <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">lty =</span> <span class="dv">2</span>) <span class="co"># equilibrium of N</span></span>
<span id="cb80-24"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb80-24" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> parms[<span class="dv">1</span>] <span class="sc">/</span> parms[<span class="dv">2</span>], <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lty =</span> <span class="dv">2</span>) <span class="co"># equilibrium of P</span></span>
<span id="cb80-25"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb80-25" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;N&quot;</span>, <span class="st">&quot;P&quot;</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="at">lty =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-42-1.png" width="672" /></p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb81-1" tabindex="-1"></a><span class="do">### Visualization -- state-space diagram</span></span>
<span id="cb81-2"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb81-2" tabindex="-1"></a><span class="fu">plot</span>(N <span class="sc">~</span> P, <span class="at">data =</span> pop_size, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span>
<span id="cb81-3"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb81-3" tabindex="-1"></a><span class="fu">points</span>(parms[<span class="dv">4</span>]<span class="sc">/</span>(parms[<span class="dv">3</span>] <span class="sc">*</span> parms[<span class="dv">2</span>]), parms[<span class="dv">1</span>] <span class="sc">/</span> parms[<span class="dv">2</span>]) <span class="co"># equilibrium</span></span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-42-2.png" width="672" /></p>
<p>What is the relationship between the <strong>long-term average</strong> of the cycle and the originally-expected equilibrium? To calculate long-term average, we need to find out the period of the cycle and then calculate the average population size within a period. The period of the cycle may be derived from the distance between peaks in the dynamics shown above, or by some algorithms, e.g. <code>pracma::findpeaks</code>.</p>
<p><br></p>
<p><strong>Part 2: Time-scale separation</strong></p>
<p>Time-scale separation is a useful technique to reduce the dimension of the model system, where some state variables are assumed to operate at a much shorter time scale (i.e., fast variables) compared with the others (i.e., slow variables). The fast variables will be attracted rapidly to their new equilibrium in response to a slight change in the slow variables, such that the slow variables can be viewed as “constants” from the perspective of fast variables (and the fast variable will always be at its quasi-equilibrium from the perspective of the slow variable).</p>
<p>Here, we are going to use the Lotka-Volterra model with logistic prey growth to demonstrate the time-scale separation technique:</p>
<p><span class="math display">\[\begin{align*}
\frac {dN}{dt} &amp;= rN(1-\frac{N}{K})-aNP\\
\frac {dP}{dt} &amp;= eaNP-dP
\end{align*}\]</span></p>
<p>The ZNGIs of <span class="math inline">\(N\)</span> are <span class="math inline">\(N = 0\)</span> and <span class="math inline">\(r(1-\frac{N}{K}) - aP = 0\)</span> and the ZNGIs of <span class="math inline">\(P\)</span> are <span class="math inline">\(P = 0\)</span> and <span class="math inline">\(eaN = d\)</span> in this model.</p>
<p>We treat <strong>prey as a fast variable and predator as a slow variable</strong>. First, we find the quasi-equilibrium <span class="math inline">\(\widehat{N}\)</span> of prey by setting the prey equation to zero:</p>
<p><span class="math display">\[\widehat{N} = K(1-\frac{aP}{r})\]</span></p>
<p>And then we plug <span class="math inline">\(\widehat{N}\)</span> into predator equation:</p>
<p><span class="math display">\[\frac {dP}{dt} = (eaK-d)P(1-\frac{eaK(\frac{a}{r})}{eaK-d}P)\]</span></p>
<p>One simple way to achieve time-scale separation in this model is to increase the prey growth rate so that prey will grow much faster than predator, mimicking the shorter generation time of prey relative to that of predator.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb82-1" tabindex="-1"></a><span class="fu">library</span>(deSolve)</span>
<span id="cb82-2"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb82-2" tabindex="-1"></a></span>
<span id="cb82-3"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb82-3" tabindex="-1"></a>Prey_logistic_model <span class="ot">&lt;-</span> <span class="cf">function</span>(times, state, parms) {</span>
<span id="cb82-4"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb82-4" tabindex="-1"></a>  <span class="fu">with</span>(<span class="fu">as.list</span>(<span class="fu">c</span>(state, parms)), {</span>
<span id="cb82-5"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb82-5" tabindex="-1"></a>    dN_dt <span class="ot">=</span> r<span class="sc">*</span>N<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>(N<span class="sc">/</span>K))<span class="sc">-</span>a<span class="sc">*</span>N<span class="sc">*</span>P</span>
<span id="cb82-6"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb82-6" tabindex="-1"></a>    dP_dt <span class="ot">=</span> e<span class="sc">*</span>a<span class="sc">*</span>N<span class="sc">*</span>P<span class="sc">-</span>d<span class="sc">*</span>P</span>
<span id="cb82-7"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb82-7" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="fu">c</span>(dN_dt, dP_dt)))</span>
<span id="cb82-8"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb82-8" tabindex="-1"></a>  })</span>
<span id="cb82-9"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb82-9" tabindex="-1"></a>}</span>
<span id="cb82-10"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb82-10" tabindex="-1"></a></span>
<span id="cb82-11"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb82-11" tabindex="-1"></a>times <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb82-12"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb82-12" tabindex="-1"></a>state <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">N =</span> <span class="dv">40</span>, <span class="at">P =</span> <span class="dv">20</span>)</span>
<span id="cb82-13"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb82-13" tabindex="-1"></a>parms <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">r =</span> <span class="dv">40</span>, <span class="at">K =</span> <span class="dv">60</span>, <span class="at">a =</span> <span class="fl">0.1</span>, <span class="at">e =</span> <span class="fl">0.1</span>, <span class="at">d =</span> <span class="fl">0.5</span>)  <span class="co"># r is chosen to be sufficiently large for time-scale separation</span></span>
<span id="cb82-14"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb82-14" tabindex="-1"></a></span>
<span id="cb82-15"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb82-15" tabindex="-1"></a>pop_size <span class="ot">&lt;-</span> <span class="fu">ode</span>(<span class="at">func =</span> Prey_logistic_model, <span class="at">times =</span> times, <span class="at">y =</span> state, <span class="at">parms =</span> parms)</span></code></pre></div>
<p>Under time-scale separation, population of prey rapidly becomes stable and predator exhibits a logistic growth. We show these by the trajectories of <span class="math inline">\(P\)</span> and <span class="math inline">\(N\)</span> over time.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb83-1" tabindex="-1"></a><span class="co"># population trajectories</span></span>
<span id="cb83-2"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb83-2" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(times)), <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(pop_size[, <span class="fu">c</span>(<span class="st">&quot;N&quot;</span>, <span class="st">&quot;P&quot;</span>)] <span class="sc">+</span> <span class="dv">10</span>)), <span class="at">type =</span> <span class="st">&quot;n&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;time&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;population size&quot;</span>)</span>
<span id="cb83-3"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb83-3" tabindex="-1"></a><span class="fu">lines</span>(N <span class="sc">~</span> time, <span class="at">data =</span> pop_size, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>) <span class="co"># dynamics of N</span></span>
<span id="cb83-4"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb83-4" tabindex="-1"></a><span class="fu">lines</span>(P <span class="sc">~</span> time, <span class="at">data =</span> pop_size, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>) <span class="co"># dynamics of P</span></span>
<span id="cb83-5"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb83-5" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;N&quot;</span>, <span class="st">&quot;P&quot;</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="at">lty =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-44-1.png" width="672" /></p>
<p>Since <span class="math inline">\(N\)</span> is a fast variable, it will immediately achieve the its ZNGI on the state-space diagram.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb84-1" tabindex="-1"></a><span class="co"># state-space diagram</span></span>
<span id="cb84-2"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb84-2" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(pop_size[, <span class="st">&quot;N&quot;</span>])), <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(pop_size[, <span class="st">&quot;P&quot;</span>])), <span class="at">type =</span> <span class="st">&quot;n&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;N&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;P&quot;</span>)</span>
<span id="cb84-3"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb84-3" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>) <span class="co"># ZNGI of N</span></span>
<span id="cb84-4"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb84-4" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> parms[<span class="dv">1</span>]<span class="sc">/</span>parms[<span class="dv">3</span>], <span class="at">b =</span> <span class="sc">-</span>parms[<span class="dv">1</span>]<span class="sc">/</span>(parms[<span class="dv">3</span>]<span class="sc">*</span>parms[<span class="dv">2</span>]), <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>) <span class="co"># ZNGI of N</span></span>
<span id="cb84-5"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb84-5" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>) <span class="co"># ZNGI of P</span></span>
<span id="cb84-6"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb84-6" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> parms[<span class="dv">5</span>]<span class="sc">/</span>(parms[<span class="dv">4</span>]<span class="sc">*</span>parms[<span class="dv">3</span>]), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>) <span class="co"># ZNGI of P</span></span>
<span id="cb84-7"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb84-7" tabindex="-1"></a><span class="fu">points</span>(P <span class="sc">~</span> N, <span class="at">data =</span> pop_size, <span class="at">col =</span> <span class="st">&quot;gray&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-45-1.png" width="672" /></p>
<p>Play with the growth rate <span class="math inline">\(r\)</span> from small to large values and see how the trajectory of prey and predator moves along the state-space.</p>
<iframe src="https://genchanghsu0115.shinyapps.io/Time_scale_sep_shinyapp/?showcase=0" width="800px" height="700px" data-external="1">
</iframe>
<p>Shiny app is credit to <a href="https://genchanghsu.github.io/index.html">Gen-Chang Hsu</a></p>
<p><strong>Part 3: Bifurcation diagram for the logistically-growing prey model</strong></p>
<p>Here, we simulate the bifurcation diagram along the prey carrying capacity. Our analytical analyses told us that this model will not end up in a cycle (i.e., the final dynamics are stable equilibria that depend on the parameter value). Therefore, this bifurcation diagram is relatively straightforward: use a for-loop to change the parameter value and record the final state.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb85-1" tabindex="-1"></a><span class="co"># Create vector for K and saving space</span></span>
<span id="cb85-2"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb85-2" tabindex="-1"></a>Parms.bifurcation <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">r =</span> <span class="fl">1.0</span>, <span class="at">K =</span> <span class="dv">60</span>, <span class="at">a =</span> <span class="fl">0.1</span>, <span class="at">e =</span> <span class="fl">0.1</span>, <span class="at">d =</span> <span class="fl">0.5</span>)</span>
<span id="cb85-3"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb85-3" tabindex="-1"></a>Times.bifurcation <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1500</span>, <span class="at">by =</span> <span class="dv">1</span>)</span>
<span id="cb85-4"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb85-4" tabindex="-1"></a>State.bifurcation <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">N =</span> <span class="dv">1</span>, <span class="at">P =</span> <span class="dv">1</span>)</span>
<span id="cb85-5"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb85-5" tabindex="-1"></a>K.vector <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">30</span>, <span class="at">to =</span> <span class="dv">70</span>, <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb85-6"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb85-6" tabindex="-1"></a>N.sim <span class="ot">&lt;-</span> <span class="fu">length</span>(K.vector)</span>
<span id="cb85-7"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb85-7" tabindex="-1"></a>Data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">K =</span> K.vector,</span>
<span id="cb85-8"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb85-8" tabindex="-1"></a>                   <span class="at">N.end =</span> <span class="fu">rep</span>(<span class="dv">0</span>, N.sim),</span>
<span id="cb85-9"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb85-9" tabindex="-1"></a>                   <span class="at">P.end =</span> <span class="fu">rep</span>(<span class="dv">0</span>, N.sim))</span>
<span id="cb85-10"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb85-10" tabindex="-1"></a></span>
<span id="cb85-11"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb85-11" tabindex="-1"></a><span class="co"># Run the simulation for each K within the vector</span></span>
<span id="cb85-12"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb85-12" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N.sim){</span>
<span id="cb85-13"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb85-13" tabindex="-1"></a>  </span>
<span id="cb85-14"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb85-14" tabindex="-1"></a>  <span class="co"># Run the simulation with updated K value</span></span>
<span id="cb85-15"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb85-15" tabindex="-1"></a>  Parms.bifurcation[<span class="st">&quot;K&quot;</span>] <span class="ot">&lt;-</span> Data<span class="sc">$</span>K[i]</span>
<span id="cb85-16"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb85-16" tabindex="-1"></a>  Temp <span class="ot">&lt;-</span> <span class="fu">ode</span>(<span class="at">func =</span> Prey_logistic_model,</span>
<span id="cb85-17"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb85-17" tabindex="-1"></a>              <span class="at">times =</span> Times.bifurcation,</span>
<span id="cb85-18"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb85-18" tabindex="-1"></a>              <span class="at">y =</span> State.bifurcation,</span>
<span id="cb85-19"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb85-19" tabindex="-1"></a>              <span class="at">parms =</span> Parms.bifurcation)</span>
<span id="cb85-20"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb85-20" tabindex="-1"></a>  <span class="co"># Since analytical analysis suggests no permanent cycles, simply take last point</span></span>
<span id="cb85-21"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb85-21" tabindex="-1"></a>  Temp <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(Temp)</span>
<span id="cb85-22"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb85-22" tabindex="-1"></a>  Data<span class="sc">$</span>N.end[i] <span class="ot">&lt;-</span> <span class="fu">tail</span>(Temp, <span class="dv">1</span>)<span class="sc">$</span>N</span>
<span id="cb85-23"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb85-23" tabindex="-1"></a>  Data<span class="sc">$</span>P.end[i] <span class="ot">&lt;-</span> <span class="fu">tail</span>(Temp, <span class="dv">1</span>)<span class="sc">$</span>P</span>
<span id="cb85-24"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb85-24" tabindex="-1"></a></span>
<span id="cb85-25"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb85-25" tabindex="-1"></a>}</span>
<span id="cb85-26"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb85-26" tabindex="-1"></a></span>
<span id="cb85-27"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb85-27" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb85-28"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb85-28" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">c</span>(<span class="fu">min</span>(K.vector), <span class="fu">max</span>(K.vector)), <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(Data[, <span class="fu">c</span>(<span class="st">&quot;N.end&quot;</span>, <span class="st">&quot;P.end&quot;</span>)]) <span class="sc">*</span> <span class="fl">1.2</span>),</span>
<span id="cb85-29"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb85-29" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;n&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;K&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Equilibrium value&quot;</span>)</span>
<span id="cb85-30"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb85-30" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>)</span>
<span id="cb85-31"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb85-31" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> Parms.bifurcation[<span class="dv">5</span>]<span class="sc">/</span>(Parms.bifurcation[<span class="dv">4</span>]<span class="sc">*</span>Parms.bifurcation[<span class="dv">3</span>]), <span class="at">col=</span><span class="st">&quot;grey&quot;</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">3</span>)</span>
<span id="cb85-32"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb85-32" tabindex="-1"></a><span class="fu">points</span>(N.end <span class="sc">~</span> K, Data, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>,<span class="at">lty =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="dv">3</span>)</span>
<span id="cb85-33"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb85-33" tabindex="-1"></a><span class="fu">points</span>(P.end <span class="sc">~</span> K, Data, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="dv">3</span>)</span>
<span id="cb85-34"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html#cb85-34" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;Prey&quot;</span>, <span class="st">&quot;Predator&quot;</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-47-1.png" width="672" /></p>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="week-10---lotka-volterra-competition-model---visualization-of-dynamics-with-complex-eigenvalues.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/ChingLinHuang/2022_Fall_TheoEcol/11_Week_11_3.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
