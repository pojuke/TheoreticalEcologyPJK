<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Week 5 - Harvesting and bifurcation | Introduction to Theoretical Ecology</title>
  <meta name="description" content="This is the course website for Introduction to Theoretical Ecology 2023 Fall at National Taiwan University." />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Week 5 - Harvesting and bifurcation | Introduction to Theoretical Ecology" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://pojuke.github.io/TheoreticalEcologyPJK/bifurcation.gif" />
  <meta property="og:description" content="This is the course website for Introduction to Theoretical Ecology 2023 Fall at National Taiwan University." />
  <meta name="github-repo" content="pojuke/TheoreticalEcologyPJK" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Week 5 - Harvesting and bifurcation | Introduction to Theoretical Ecology" />
  
  <meta name="twitter:description" content="This is the course website for Introduction to Theoretical Ecology 2023 Fall at National Taiwan University." />
  <meta name="twitter:image" content="https://pojuke.github.io/TheoreticalEcologyPJK/bifurcation.gif" />

<meta name="author" content="Instructor: Po-Ju Ke ~~~~~ Teaching Assistant: Sun Yi" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="week-4---metapopulations-and-patch-occupancy-models.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Introduction to Theoretical Ecology</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Course information</a></li>
<li class="chapter" data-level="" data-path="week-2---exponential-population-growth.html"><a href="week-2---exponential-population-growth.html"><i class="fa fa-check"></i>Week 2 - Exponential population growth</a></li>
<li class="chapter" data-level="" data-path="week-3---logistic-population-growth-and-stability-analysis.html"><a href="week-3---logistic-population-growth-and-stability-analysis.html"><i class="fa fa-check"></i>Week 3 - Logistic population growth and stability analysis</a></li>
<li class="chapter" data-level="" data-path="week-4---metapopulations-and-patch-occupancy-models.html"><a href="week-4---metapopulations-and-patch-occupancy-models.html"><i class="fa fa-check"></i>Week 4 - Metapopulations and patch occupancy models</a></li>
<li class="chapter" data-level="" data-path="week-5---harvesting-and-bifurcation.html"><a href="week-5---harvesting-and-bifurcation.html"><i class="fa fa-check"></i>Week 5 - Harvesting and bifurcation</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to Theoretical Ecology</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="week-5---harvesting-and-bifurcation" class="section level1 unnumbered hasAnchor">
<h1>Week 5 - Harvesting and bifurcation<a href="week-5---harvesting-and-bifurcation.html#week-5---harvesting-and-bifurcation" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this lab section, we’re going to analyze the budworm population dynamic model from <a href="https://doi.org/10.2307/3939"><strong>Ludwig et al., 1978</strong></a>.</p>
<p><br>
<strong>Part 1 - Stability of the budworm model</strong></p>
<p>In part 1 we’re going to visulize the stability of the budworm model, by plotting the differential equation. By plotting the the differential equation with different initial, we could see that the number of equilibrium changes.</p>
<p><span class="math display">\[
\dfrac{dN}{dt} = rN(1 - \dfrac{N}{K}) - \dfrac{BN^2}{A^2 + N^2}
\]</span></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="week-5---harvesting-and-bifurcation.html#cb1-1" tabindex="-1"></a><span class="do">#### Plotting the functional form for different parameters</span></span>
<span id="cb1-2"><a href="week-5---harvesting-and-bifurcation.html#cb1-2" tabindex="-1"></a><span class="do">#### Parameter setting</span></span>
<span id="cb1-3"><a href="week-5---harvesting-and-bifurcation.html#cb1-3" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fl">0.055</span>; K <span class="ot">&lt;-</span> <span class="dv">10</span>; B <span class="ot">&lt;-</span> <span class="fl">0.1</span>; A <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb1-4"><a href="week-5---harvesting-and-bifurcation.html#cb1-4" tabindex="-1"></a></span>
<span id="cb1-5"><a href="week-5---harvesting-and-bifurcation.html#cb1-5" tabindex="-1"></a><span class="do">#### Visualize the whole dN/dt</span></span>
<span id="cb1-6"><a href="week-5---harvesting-and-bifurcation.html#cb1-6" tabindex="-1"></a>N.vec <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">10</span>, <span class="at">length =</span> <span class="dv">500</span>)</span>
<span id="cb1-7"><a href="week-5---harvesting-and-bifurcation.html#cb1-7" tabindex="-1"></a>r.breaks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.03</span>, <span class="fl">0.05</span>, <span class="fl">0.07</span>)</span>
<span id="cb1-8"><a href="week-5---harvesting-and-bifurcation.html#cb1-8" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">outer</span>(<span class="at">X =</span> N.vec, <span class="at">Y =</span> r.breaks,</span>
<span id="cb1-9"><a href="week-5---harvesting-and-bifurcation.html#cb1-9" tabindex="-1"></a>             <span class="cf">function</span>(N, r){r <span class="sc">*</span> N <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> N <span class="sc">/</span> K) <span class="sc">-</span> (B <span class="sc">*</span> N<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (A<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> N<span class="sc">^</span><span class="dv">2</span>))})</span>
<span id="cb1-10"><a href="week-5---harvesting-and-bifurcation.html#cb1-10" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x =</span> N.vec, <span class="at">y =</span> dat, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, </span>
<span id="cb1-11"><a href="week-5---harvesting-and-bifurcation.html#cb1-11" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">&quot;N&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;dN/dt&quot;</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">las =</span> <span class="dv">1</span>)</span>
<span id="cb1-12"><a href="week-5---harvesting-and-bifurcation.html#cb1-12" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>)</span>
<span id="cb1-13"><a href="week-5---harvesting-and-bifurcation.html#cb1-13" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="at">legend =</span> r.breaks, <span class="at">title =</span> <span class="st">&quot;r&quot;</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-1-1.png" width="672" />
<span class="math display">\[
\dfrac{dN}{dt}[r(1 - \dfrac{N}{K})] = \dfrac{dN}{dt}[\dfrac{BN^2}{A^2 + N^2}]
\]</span></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="week-5---harvesting-and-bifurcation.html#cb2-1" tabindex="-1"></a><span class="do">#### Visualize separate components of dN/dt</span></span>
<span id="cb2-2"><a href="week-5---harvesting-and-bifurcation.html#cb2-2" tabindex="-1"></a>N.vec <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">10</span>, <span class="at">length =</span> <span class="dv">500</span>)</span>
<span id="cb2-3"><a href="week-5---harvesting-and-bifurcation.html#cb2-3" tabindex="-1"></a>r.breaks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.03</span>, <span class="fl">0.05</span>, <span class="fl">0.07</span>)</span>
<span id="cb2-4"><a href="week-5---harvesting-and-bifurcation.html#cb2-4" tabindex="-1"></a>dat.growth <span class="ot">&lt;-</span> <span class="fu">outer</span>(<span class="at">X =</span> N.vec, <span class="at">Y =</span> r.breaks,</span>
<span id="cb2-5"><a href="week-5---harvesting-and-bifurcation.html#cb2-5" tabindex="-1"></a>                    <span class="cf">function</span>(N, r){r <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> N <span class="sc">/</span> K)}) </span>
<span id="cb2-6"><a href="week-5---harvesting-and-bifurcation.html#cb2-6" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x =</span> N.vec, <span class="at">y =</span> dat.growth, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.08</span>), <span class="at">las =</span> <span class="dv">1</span>, </span>
<span id="cb2-7"><a href="week-5---harvesting-and-bifurcation.html#cb2-7" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">&quot;N&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;growth / harvest rate&quot;</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb2-8"><a href="week-5---harvesting-and-bifurcation.html#cb2-8" tabindex="-1"></a><span class="fu">curve</span>(B <span class="sc">*</span> x <span class="sc">/</span> (A<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> x<span class="sc">^</span><span class="dv">2</span>), <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>) <span class="co"># Just curve since its the same line, and note variable notation change</span></span>
<span id="cb2-9"><a href="week-5---harvesting-and-bifurcation.html#cb2-9" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>)</span>
<span id="cb2-10"><a href="week-5---harvesting-and-bifurcation.html#cb2-10" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> r.breaks, <span class="at">title =</span> <span class="st">&quot;r&quot;</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="week-5---harvesting-and-bifurcation.html#cb3-1" tabindex="-1"></a><span class="do">#### 2-D bifurcation diagram following analytical solution from Strogatz</span></span>
<span id="cb3-2"><a href="week-5---harvesting-and-bifurcation.html#cb3-2" tabindex="-1"></a><span class="do">#### For nondimensionalized model dx/du = rx(1-x/k) - x^2/(1+x^2)</span></span>
<span id="cb3-3"><a href="week-5---harvesting-and-bifurcation.html#cb3-3" tabindex="-1"></a><span class="do">#### There exist parametric curves for bifurcation points r(x) and k(x)</span></span>
<span id="cb3-4"><a href="week-5---harvesting-and-bifurcation.html#cb3-4" tabindex="-1"></a>x.bifur <span class="ot">=</span> <span class="fu">seq</span>(<span class="fl">1.001</span>, <span class="dv">50</span>, <span class="at">by =</span> <span class="fl">0.001</span>)</span>
<span id="cb3-5"><a href="week-5---harvesting-and-bifurcation.html#cb3-5" tabindex="-1"></a>bifur2D <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">x.bifur =</span> x.bifur, </span>
<span id="cb3-6"><a href="week-5---harvesting-and-bifurcation.html#cb3-6" tabindex="-1"></a>                     <span class="at">r.bifur =</span> <span class="dv">2</span> <span class="sc">*</span> x.bifur<span class="sc">^</span><span class="dv">3</span> <span class="sc">/</span> ((<span class="dv">1</span> <span class="sc">+</span> x.bifur<span class="sc">^</span><span class="dv">2</span>)<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb3-7"><a href="week-5---harvesting-and-bifurcation.html#cb3-7" tabindex="-1"></a>                     <span class="at">k.bifur =</span> <span class="dv">2</span> <span class="sc">*</span> x.bifur<span class="sc">^</span><span class="dv">3</span> <span class="sc">/</span> (x.bifur<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb3-8"><a href="week-5---harvesting-and-bifurcation.html#cb3-8" tabindex="-1"></a><span class="fu">plot</span>(r.bifur <span class="sc">~</span> k.bifur, bifur2D, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">las =</span> <span class="dv">1</span>, </span>
<span id="cb3-9"><a href="week-5---harvesting-and-bifurcation.html#cb3-9" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">60</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(bifur2D<span class="sc">$</span>r.bifur) <span class="sc">*</span> <span class="fl">1.1</span>), </span>
<span id="cb3-10"><a href="week-5---harvesting-and-bifurcation.html#cb3-10" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;K&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;r&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Budworm model bifurcation along r-k space&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-2-2.png" width="672" /></p>
<!-- **Part 2 - Using "deSolve" function "ode" to brute-force stable solution** -->
<!-- ```{r} -->
<!-- #### Budworm model for deSolve -->
<!-- BudwormODE <- function(times, state, parms) { -->
<!--   with(as.list(c(state, parms)), { -->
<!--     dN_dt = r * N * (1 - N / K) - (B * N^2 / (A^2 + N^2)) -->
<!--     return(list(c(dN_dt)))   -->
<!--   }) -->
<!-- } -->
<!-- ### Parameters setting -->
<!-- times <- seq(0, 10000, by = 10)  -->
<!-- state <- c(N = 10)  -->
<!-- #### Bifurcation diagram for r -- the forward branch -->
<!-- ### Set first forward simulation and saving space -->
<!-- r.vec.forward <- seq(0.01, 0.07, by = 0.00001) -->
<!-- parms <- c(r = r.vec.forward[1], K = 10, B = 0.1, A = 1)   -->
<!-- temp <- deSolve::ode(func = BudwormODE, times = times, y = state, parms = parms) -->
<!-- forward <- matrix(rep(unname(c(r.vec.forward[1], temp[length(times), 2])), length(r.vec.forward)), -->
<!--                   nrow = length(r.vec.forward), ncol = 2, byrow = T) -->
<!-- ## Run across forward vector, using previous step equilibrium as new initial state -->
<!-- for(i in 2:length(r.vec.forward)){ -->
<!--   state <- c(N = forward[i-1, 2])   -->
<!--   parms <- c(r = r.vec.forward[i], K = 10, B = 0.1, A = 1)  -->
<!--   temp <- deSolve::ode(func = BudwormODE, times = times, y = state, parms = parms) -->
<!--   forward[i, ] = unname(c(r.vec.forward[i], temp[length(times), 2])) -->
<!-- } -->
<!-- #### Bifurcation diagram for r -- the backward branch -->
<!-- ## Set first backward simulation and saving space -->
<!-- r.vec.backward <- rev(r.vec.forward) -->
<!-- parms <- c(r = r.vec.backward[1], K = 10, B = 0.1, A = 1)   -->
<!-- temp <- deSolve::ode(func = BudwormODE, times = times, y = state, parms = parms) -->
<!-- backward <- matrix(rep(unname(c(r.vec.backward[1], temp[length(times), 2])), length(r.vec.backward)), -->
<!--                    nrow = length(r.vec.backward), ncol = 2, byrow = T) -->
<!-- ## Run across backward vector, using previous step equilibrium as new initial state -->
<!-- for(i in 2:length(r.vec.backward)){ -->
<!--   state <- c(N = backward[i-1, 2])   -->
<!--   parms <- c(r = r.vec.backward[i], K = 10, B = 0.1, A = 1)  -->
<!--   temp <- deSolve::ode(func = BudwormODE, times = times, y = state, parms = parms) -->
<!--   backward[i, ] = unname(c(r.vec.backward[i], temp[length(times), 2])) -->
<!-- } -->
<!-- #### Plot both forward and backward branch -->
<!-- plot(forward[, 1], forward[, 2], -->
<!--      xlim = range(r.vec.forward), ylim = c(0, 10), las = 1, pch = 15, col = "darkblue",   -->
<!--      xlab = "r", ylab = "Equilibrium density, N*", main = "Budworm model bifurcation along r") -->
<!-- points(backward[, 1], backward[, 2], pch = 15, col = "darkblue") -->
<!-- ``` -->
<!-- ```{r} -->
<!-- #### Stability of the budworm model, as a function of its parameters -->
<!-- #### Using "rootSolve" function "gradient" and "uniroot.all"  -->
<!-- #### Works best for simple models and those with known solutions -->
<!-- ######################################################################################################################## -->
<!-- #### Load package and parameter setting -->
<!-- require(rootSolve)  -->
<!-- r <- 0.055 -->
<!-- K <- 10 -->
<!-- B <- 0.1 -->
<!-- A <- 1 -->
<!-- #### Spruce budworm model for rootSolve -->
<!-- Budworm <- function(N, r = 0.055, K = 10){ -->
<!--   r * N * (1 - N / K) - (B * N^2 / (A^2 + N^2)) -->
<!-- }  -->
<!-- #### Function of root stability   -->
<!-- Stability <- function(r = 0.055, K = 10){ -->
<!--   equilibrium <- uniroot.all(f = Budworm, interval = c(0, K), r = r, K = K) # finds all roots -->
<!--   lambda <- vector(mode = "numeric", length = length(equilibrium)) -->
<!--   for(i in 1:length(equilibrium)){ -->
<!--     lambda[i] <- sign(gradient(f = Budworm, x = equilibrium[i], r = r, K = K )) -->
<!--   } -->
<!--   return(list(Equilibrium = equilibrium,  -->
<!--               Lambda = lambda)) -->
<!-- } -->
<!-- #### Bifurcation diagram for r -->
<!-- r.vec <- seq(0.01, 0.07, by = 0.0001) -->
<!-- ## Create plotting frame -->
<!-- plot(0, xlim = range(r.vec), ylim = c(0, 10), type = "n", las = 1,  -->
<!--      xlab = "r", ylab = "Equilibrium density, N*", main = "Budworm model bifurcation along r") -->
<!-- legend("topleft", pch = 15, pt.cex = 2, c("stable", "unstable"), -->
<!--        col = c("darkblue", "lightblue")) -->
<!-- ## Calculate number of roots and stability across range or r -->
<!-- for(r in r.vec){ -->
<!--   temp <- Stability(r = r)  -->
<!--   points(x = rep(r, length(temp$Equilibrium)),  -->
<!--          y = temp$Equilibrium,  -->
<!--          pch = 15, col = ifelse(temp$Lambda == -1, "darkblue", "lightblue")) -->
<!-- } -->
<!-- #### Bifurcation diagram for K -->
<!-- K.vec <- seq(0.1, 14, by = 0.01) -->
<!-- ## Create plotting frame -->
<!-- plot(0, xlim = range(K.vec), ylim = c(0, 14), type = "n", las = 1,  -->
<!--      xlab = "K", ylab = "Equilibrium density, N*", main = "Budworm model bifurcation along K") -->
<!-- legend("topleft", pch = 15, pt.cex = 2, c("stable", "unstable"), -->
<!--        col = c("darkblue", "lightblue")) -->
<!-- ## Calculate number of roots and stability across range or r -->
<!-- for(K in K.vec){ -->
<!--   temp <- Stability(K = K)  -->
<!--   points(x = rep(K, length(temp$Equilibrium)),  -->
<!--          y = temp$Equilibrium,  -->
<!--          pch = 15, col = ifelse(temp$Lambda == -1, "darkblue", "lightblue")) -->
<!-- } -->
<!-- ``` -->
<!-- Take a look a this [**website**](https://www.math.ksu.edu/~albin/teaching/math340_fall2018/slides/03_bifurcations.html) if your interested in more details of bifurcation. -->

</div>
            </section>

          </div>
        </div>
      </div>
<a href="week-4---metapopulations-and-patch-occupancy-models.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/ChingLinHuang/2022_Fall_TheoEcol/05_Week_5.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
