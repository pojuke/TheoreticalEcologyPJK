<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Week 6 - Harvesting and bifurcation | Introduction to Theoretical Ecology</title>
  <meta name="description" content="This is the course website for Introduction to Theoretical Ecology 2024 Fall at National Taiwan University." />
  <meta name="generator" content="bookdown 0.39 and GitBook 2.6.7" />

  <meta property="og:title" content="Week 6 - Harvesting and bifurcation | Introduction to Theoretical Ecology" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://pojuke.github.io/TheoreticalEcologyPJK/bifurcation.gif" />
  <meta property="og:description" content="This is the course website for Introduction to Theoretical Ecology 2024 Fall at National Taiwan University." />
  <meta name="github-repo" content="pojuke/TheoreticalEcologyPJK" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Week 6 - Harvesting and bifurcation | Introduction to Theoretical Ecology" />
  
  <meta name="twitter:description" content="This is the course website for Introduction to Theoretical Ecology 2024 Fall at National Taiwan University." />
  <meta name="twitter:image" content="https://pojuke.github.io/TheoreticalEcologyPJK/bifurcation.gif" />

<meta name="author" content="Instructor: Po-Ju Ke ~~~~~ Teaching Assistant: Hsiang-Chih Lo" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="week-5---metapopulations-and-patch-occupancy-models.html"/>
<link rel="next" href="week-7---age-structure-population-model.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Introduction to Theoretical Ecology</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Course information</a></li>
<li class="chapter" data-level="" data-path="syllabus.html"><a href="syllabus.html"><i class="fa fa-check"></i>Syllabus</a></li>
<li class="chapter" data-level="" data-path="week-2---exponential-population-growth.html"><a href="week-2---exponential-population-growth.html"><i class="fa fa-check"></i>Week 2 - Exponential population growth</a></li>
<li class="chapter" data-level="" data-path="week-4---logistic-population-growth-and-stability-analysis.html"><a href="week-4---logistic-population-growth-and-stability-analysis.html"><i class="fa fa-check"></i>Week 4 - Logistic population growth and stability analysis</a></li>
<li class="chapter" data-level="" data-path="week-5---metapopulations-and-patch-occupancy-models.html"><a href="week-5---metapopulations-and-patch-occupancy-models.html"><i class="fa fa-check"></i>Week 5 - Metapopulations and patch occupancy models</a></li>
<li class="chapter" data-level="" data-path="week-6---harvesting-and-bifurcation.html"><a href="week-6---harvesting-and-bifurcation.html"><i class="fa fa-check"></i>Week 6 - Harvesting and bifurcation</a></li>
<li class="chapter" data-level="" data-path="week-7---age-structure-population-model.html"><a href="week-7---age-structure-population-model.html"><i class="fa fa-check"></i>Week 7 - Age-structure population model</a></li>
<li class="chapter" data-level="" data-path="week-8---lotka-volterra-competition-model---population-dynamics.html"><a href="week-8---lotka-volterra-competition-model---population-dynamics.html"><i class="fa fa-check"></i>Week 8 - Lotka-Volterra competition model - Population dynamics</a></li>
<li class="chapter" data-level="" data-path="week-10---lotka-volterra-competition-model---visualization-of-dynamics-with-complex-eigenvalues.html"><a href="week-10---lotka-volterra-competition-model---visualization-of-dynamics-with-complex-eigenvalues.html"><i class="fa fa-check"></i>Week 10 - Lotka-Volterra competition model - Visualization of dynamics with complex eigenvalues</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to Theoretical Ecology</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="week-6---harvesting-and-bifurcation" class="section level1 unnumbered hasAnchor">
<h1>Week 6 - Harvesting and bifurcation<a href="week-6---harvesting-and-bifurcation.html#week-6---harvesting-and-bifurcation" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this lab section, we’re going to analyze the budworm population
dynamic model from <a href="https://doi.org/10.2307/3939"><strong>Ludwig et al.,
1978</strong></a>.</p>
<p><br> <strong>Part 1 - Stability of the budworm model</strong></p>
<p>In part 1 we’re going to visualize the stability of the budworm model,
by plotting the differential equation. We will plot the the differential
equation with different initial, which we will see that the number and stability of equilibrium changes when parameter changes.</p>
<p><span class="math display">\[
\dfrac{dN}{dt} = rN(1 - \dfrac{N}{K}) - \dfrac{HN^2}{A^2 + N^2}
\]</span></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="week-6---harvesting-and-bifurcation.html#cb32-1" tabindex="-1"></a><span class="do">#### Plotting the functional form for different parameters</span></span>
<span id="cb32-2"><a href="week-6---harvesting-and-bifurcation.html#cb32-2" tabindex="-1"></a><span class="do">#### Parameter setting</span></span>
<span id="cb32-3"><a href="week-6---harvesting-and-bifurcation.html#cb32-3" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fl">0.055</span>; K <span class="ot">&lt;-</span> <span class="dv">10</span>; H <span class="ot">&lt;-</span> <span class="fl">0.1</span>; A <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb32-4"><a href="week-6---harvesting-and-bifurcation.html#cb32-4" tabindex="-1"></a></span>
<span id="cb32-5"><a href="week-6---harvesting-and-bifurcation.html#cb32-5" tabindex="-1"></a><span class="do">#### Visualize the whole dN/dt with different H</span></span>
<span id="cb32-6"><a href="week-6---harvesting-and-bifurcation.html#cb32-6" tabindex="-1"></a>N.vec <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">10</span>, <span class="at">length =</span> <span class="dv">500</span>)</span>
<span id="cb32-7"><a href="week-6---harvesting-and-bifurcation.html#cb32-7" tabindex="-1"></a>H.breaks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.12</span>, <span class="fl">0.20</span>)</span>
<span id="cb32-8"><a href="week-6---harvesting-and-bifurcation.html#cb32-8" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">outer</span>(<span class="at">X =</span> N.vec, <span class="at">Y =</span> H.breaks,</span>
<span id="cb32-9"><a href="week-6---harvesting-and-bifurcation.html#cb32-9" tabindex="-1"></a>             <span class="cf">function</span>(N, H){r <span class="sc">*</span> N <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> N <span class="sc">/</span> K) <span class="sc">-</span> (H <span class="sc">*</span> N<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (A<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> N<span class="sc">^</span><span class="dv">2</span>))})</span>
<span id="cb32-10"><a href="week-6---harvesting-and-bifurcation.html#cb32-10" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x =</span> N.vec, <span class="at">y =</span> dat, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, </span>
<span id="cb32-11"><a href="week-6---harvesting-and-bifurcation.html#cb32-11" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">&quot;N&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;dN/dt&quot;</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">las =</span> <span class="dv">1</span>)</span>
<span id="cb32-12"><a href="week-6---harvesting-and-bifurcation.html#cb32-12" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>)</span>
<span id="cb32-13"><a href="week-6---harvesting-and-bifurcation.html#cb32-13" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="at">legend =</span> H.breaks, <span class="at">title =</span> <span class="st">&quot;H&quot;</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-24-1.png" width="672" />
<br></p>
<p>Second, we’re going to plot <span class="math inline">\(harvest\)</span> rate against <span class="math inline">\(N\)</span> with
separate components of <span class="math inline">\(dN/Ndt\)</span>, which the blue line is
<span class="math display">\[
\dfrac{HN}{A^2 + N^2}
\]</span>
with different <span class="math inline">\(H\)</span>, the red line is,
<span class="math display">\[
r(1 - \dfrac{N}{K})
\]</span>
and the points that blue line and red line crosses are the equilibrium points.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="week-6---harvesting-and-bifurcation.html#cb33-1" tabindex="-1"></a><span class="do">#### Visualize separate components of dN/Ndt with different H</span></span>
<span id="cb33-2"><a href="week-6---harvesting-and-bifurcation.html#cb33-2" tabindex="-1"></a>N.vec <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">10</span>, <span class="at">length =</span> <span class="dv">500</span>)</span>
<span id="cb33-3"><a href="week-6---harvesting-and-bifurcation.html#cb33-3" tabindex="-1"></a>H.breaks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.12</span>, <span class="fl">0.20</span>)</span>
<span id="cb33-4"><a href="week-6---harvesting-and-bifurcation.html#cb33-4" tabindex="-1"></a>dat.growth <span class="ot">&lt;-</span> <span class="fu">outer</span>(<span class="at">X =</span> N.vec, <span class="at">Y =</span> H.breaks,</span>
<span id="cb33-5"><a href="week-6---harvesting-and-bifurcation.html#cb33-5" tabindex="-1"></a>                    <span class="cf">function</span>(N, H){H <span class="sc">*</span> N <span class="sc">/</span> (A<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> N<span class="sc">^</span><span class="dv">2</span>)}) <span class="co"># Note notation change</span></span>
<span id="cb33-6"><a href="week-6---harvesting-and-bifurcation.html#cb33-6" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x =</span> N.vec, <span class="at">y =</span> dat.growth, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.10</span>), <span class="at">las =</span> <span class="dv">1</span>, </span>
<span id="cb33-7"><a href="week-6---harvesting-and-bifurcation.html#cb33-7" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">&quot;N&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;growth / harvest rate&quot;</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb33-8"><a href="week-6---harvesting-and-bifurcation.html#cb33-8" tabindex="-1"></a><span class="fu">curve</span>(r <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> x<span class="sc">/</span>K), <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>) <span class="co"># Just curve since its the same line, and note variable notation change</span></span>
<span id="cb33-9"><a href="week-6---harvesting-and-bifurcation.html#cb33-9" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>)</span>
<span id="cb33-10"><a href="week-6---harvesting-and-bifurcation.html#cb33-10" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> H.breaks, <span class="at">title =</span> <span class="st">&quot;H&quot;</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-25-1.png" width="672" />
<br></p>
<p><strong>Part 2 - Use <code>rootSolve</code> function <code>gradient</code> and <code>uniroot.all</code>, to solve stability of budworm model</strong></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="week-6---harvesting-and-bifurcation.html#cb34-1" tabindex="-1"></a><span class="do">#### Stability of the budworm model, as a function of its parameters</span></span>
<span id="cb34-2"><a href="week-6---harvesting-and-bifurcation.html#cb34-2" tabindex="-1"></a><span class="do">#### Using &quot;rootSolve&quot; function &quot;gradient&quot; and &quot;uniroot.all&quot;</span></span>
<span id="cb34-3"><a href="week-6---harvesting-and-bifurcation.html#cb34-3" tabindex="-1"></a><span class="do">#### Works best for simple models and those with known solutions</span></span>
<span id="cb34-4"><a href="week-6---harvesting-and-bifurcation.html#cb34-4" tabindex="-1"></a><span class="do">########################################################################################################################</span></span>
<span id="cb34-5"><a href="week-6---harvesting-and-bifurcation.html#cb34-5" tabindex="-1"></a><span class="fu">library</span>(rootSolve)</span>
<span id="cb34-6"><a href="week-6---harvesting-and-bifurcation.html#cb34-6" tabindex="-1"></a><span class="do">#### Parameter setting</span></span>
<span id="cb34-7"><a href="week-6---harvesting-and-bifurcation.html#cb34-7" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fl">0.055</span>; K <span class="ot">&lt;-</span> <span class="dv">10</span>; H <span class="ot">&lt;-</span> <span class="fl">0.1</span>; A <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb34-8"><a href="week-6---harvesting-and-bifurcation.html#cb34-8" tabindex="-1"></a></span>
<span id="cb34-9"><a href="week-6---harvesting-and-bifurcation.html#cb34-9" tabindex="-1"></a><span class="do">#### Spruce budworm model for rootSolve</span></span>
<span id="cb34-10"><a href="week-6---harvesting-and-bifurcation.html#cb34-10" tabindex="-1"></a>Budworm <span class="ot">&lt;-</span> <span class="cf">function</span>(N, <span class="at">H =</span> <span class="fl">0.1</span>){</span>
<span id="cb34-11"><a href="week-6---harvesting-and-bifurcation.html#cb34-11" tabindex="-1"></a>  r <span class="sc">*</span> N <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> N <span class="sc">/</span> K) <span class="sc">-</span> (H <span class="sc">*</span> N<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (A<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> N<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb34-12"><a href="week-6---harvesting-and-bifurcation.html#cb34-12" tabindex="-1"></a>}</span>
<span id="cb34-13"><a href="week-6---harvesting-and-bifurcation.html#cb34-13" tabindex="-1"></a></span>
<span id="cb34-14"><a href="week-6---harvesting-and-bifurcation.html#cb34-14" tabindex="-1"></a><span class="do">#### Function of root stability</span></span>
<span id="cb34-15"><a href="week-6---harvesting-and-bifurcation.html#cb34-15" tabindex="-1"></a>Stability <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">H.value =</span> <span class="fl">0.1</span>){</span>
<span id="cb34-16"><a href="week-6---harvesting-and-bifurcation.html#cb34-16" tabindex="-1"></a>  equilibrium <span class="ot">&lt;-</span> <span class="fu">uniroot.all</span>(<span class="at">f =</span> Budworm, <span class="at">interval =</span> <span class="fu">c</span>(<span class="dv">0</span>, K), <span class="at">H =</span> H.value) <span class="co"># finds all roots</span></span>
<span id="cb34-17"><a href="week-6---harvesting-and-bifurcation.html#cb34-17" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">&quot;numeric&quot;</span>, <span class="at">length =</span> <span class="fu">length</span>(equilibrium))</span>
<span id="cb34-18"><a href="week-6---harvesting-and-bifurcation.html#cb34-18" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(equilibrium)){</span>
<span id="cb34-19"><a href="week-6---harvesting-and-bifurcation.html#cb34-19" tabindex="-1"></a>    lambda[i] <span class="ot">&lt;-</span> <span class="fu">sign</span>(<span class="fu">gradient</span>(<span class="at">f =</span> Budworm, <span class="at">x =</span> equilibrium[i], <span class="at">H =</span> H.value))</span>
<span id="cb34-20"><a href="week-6---harvesting-and-bifurcation.html#cb34-20" tabindex="-1"></a>  }</span>
<span id="cb34-21"><a href="week-6---harvesting-and-bifurcation.html#cb34-21" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">Equilibrium =</span> equilibrium,</span>
<span id="cb34-22"><a href="week-6---harvesting-and-bifurcation.html#cb34-22" tabindex="-1"></a>              <span class="at">Lambda =</span> lambda))</span>
<span id="cb34-23"><a href="week-6---harvesting-and-bifurcation.html#cb34-23" tabindex="-1"></a>}</span>
<span id="cb34-24"><a href="week-6---harvesting-and-bifurcation.html#cb34-24" tabindex="-1"></a></span>
<span id="cb34-25"><a href="week-6---harvesting-and-bifurcation.html#cb34-25" tabindex="-1"></a><span class="do">#### Bifurcation diagram for H</span></span>
<span id="cb34-26"><a href="week-6---harvesting-and-bifurcation.html#cb34-26" tabindex="-1"></a>H.vec <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.001</span>, <span class="fl">0.3</span>, <span class="at">by =</span> <span class="fl">0.0001</span>)</span>
<span id="cb34-27"><a href="week-6---harvesting-and-bifurcation.html#cb34-27" tabindex="-1"></a></span>
<span id="cb34-28"><a href="week-6---harvesting-and-bifurcation.html#cb34-28" tabindex="-1"></a><span class="do">## Create plotting frame</span></span>
<span id="cb34-29"><a href="week-6---harvesting-and-bifurcation.html#cb34-29" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">0</span>, <span class="at">xlim =</span> <span class="fu">range</span>(H.vec), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="at">type =</span> <span class="st">&quot;n&quot;</span>, <span class="at">las =</span> <span class="dv">1</span>,</span>
<span id="cb34-30"><a href="week-6---harvesting-and-bifurcation.html#cb34-30" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;H&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Equilibrium density, N*&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Budworm model bifurcation along H&quot;</span>)</span>
<span id="cb34-31"><a href="week-6---harvesting-and-bifurcation.html#cb34-31" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">pch =</span> <span class="dv">15</span>, <span class="at">pt.cex =</span> <span class="dv">2</span>, <span class="fu">c</span>(<span class="st">&quot;stable&quot;</span>, <span class="st">&quot;unstable&quot;</span>),</span>
<span id="cb34-32"><a href="week-6---harvesting-and-bifurcation.html#cb34-32" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;darkblue&quot;</span>, <span class="st">&quot;lightblue&quot;</span>))</span>
<span id="cb34-33"><a href="week-6---harvesting-and-bifurcation.html#cb34-33" tabindex="-1"></a></span>
<span id="cb34-34"><a href="week-6---harvesting-and-bifurcation.html#cb34-34" tabindex="-1"></a><span class="do">## Calculate number of roots and stability across range of H</span></span>
<span id="cb34-35"><a href="week-6---harvesting-and-bifurcation.html#cb34-35" tabindex="-1"></a><span class="cf">for</span>(H <span class="cf">in</span> H.vec){</span>
<span id="cb34-36"><a href="week-6---harvesting-and-bifurcation.html#cb34-36" tabindex="-1"></a>  temp <span class="ot">&lt;-</span> <span class="fu">Stability</span>(<span class="at">H.value =</span> H)</span>
<span id="cb34-37"><a href="week-6---harvesting-and-bifurcation.html#cb34-37" tabindex="-1"></a>  <span class="fu">points</span>(<span class="at">x =</span> <span class="fu">rep</span>(H, <span class="fu">length</span>(temp<span class="sc">$</span>Equilibrium)),</span>
<span id="cb34-38"><a href="week-6---harvesting-and-bifurcation.html#cb34-38" tabindex="-1"></a>         <span class="at">y =</span> temp<span class="sc">$</span>Equilibrium,</span>
<span id="cb34-39"><a href="week-6---harvesting-and-bifurcation.html#cb34-39" tabindex="-1"></a>         <span class="at">pch =</span> <span class="dv">15</span>, <span class="at">col =</span> <span class="fu">ifelse</span>(temp<span class="sc">$</span>Lambda <span class="sc">==</span> <span class="sc">-</span><span class="dv">1</span>, <span class="st">&quot;darkblue&quot;</span>, <span class="st">&quot;lightblue&quot;</span>))</span>
<span id="cb34-40"><a href="week-6---harvesting-and-bifurcation.html#cb34-40" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-26-1.png" width="672" />
<br></p>
<p>Take a look a this
<a href="https://www.math.ksu.edu/~albin/teaching/math340_fall2018/slides/03_bifurcations.html"><strong>website</strong></a> if you’re interested in more details of bifurcation.
<br>
<br></p>
<p><strong>Extra materials</strong>
<br>
<strong>Using <code>deSolve</code> function <code>ode</code> to brute-force stable solution</strong></p>
<p>Here we’re going to use <code>deSolve</code> to solve the budworm model,</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="week-6---harvesting-and-bifurcation.html#cb35-1" tabindex="-1"></a><span class="do">#### Budworm model for deSolve</span></span>
<span id="cb35-2"><a href="week-6---harvesting-and-bifurcation.html#cb35-2" tabindex="-1"></a></span>
<span id="cb35-3"><a href="week-6---harvesting-and-bifurcation.html#cb35-3" tabindex="-1"></a><span class="fu">library</span>(deSolve)</span>
<span id="cb35-4"><a href="week-6---harvesting-and-bifurcation.html#cb35-4" tabindex="-1"></a></span>
<span id="cb35-5"><a href="week-6---harvesting-and-bifurcation.html#cb35-5" tabindex="-1"></a>BudwormODE <span class="ot">&lt;-</span> <span class="cf">function</span>(times, state, parms) {</span>
<span id="cb35-6"><a href="week-6---harvesting-and-bifurcation.html#cb35-6" tabindex="-1"></a>  <span class="fu">with</span>(<span class="fu">as.list</span>(<span class="fu">c</span>(state, parms)), {</span>
<span id="cb35-7"><a href="week-6---harvesting-and-bifurcation.html#cb35-7" tabindex="-1"></a>    dN_dt <span class="ot">=</span> r <span class="sc">*</span> N <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> N <span class="sc">/</span> K) <span class="sc">-</span> (H <span class="sc">*</span> N<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (A<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> N<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb35-8"><a href="week-6---harvesting-and-bifurcation.html#cb35-8" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="fu">c</span>(dN_dt)))</span>
<span id="cb35-9"><a href="week-6---harvesting-and-bifurcation.html#cb35-9" tabindex="-1"></a>  })</span>
<span id="cb35-10"><a href="week-6---harvesting-and-bifurcation.html#cb35-10" tabindex="-1"></a>}</span>
<span id="cb35-11"><a href="week-6---harvesting-and-bifurcation.html#cb35-11" tabindex="-1"></a></span>
<span id="cb35-12"><a href="week-6---harvesting-and-bifurcation.html#cb35-12" tabindex="-1"></a><span class="do">### Parameters setting</span></span>
<span id="cb35-13"><a href="week-6---harvesting-and-bifurcation.html#cb35-13" tabindex="-1"></a>times <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">5000</span>, <span class="at">by =</span> <span class="dv">100</span>)</span>
<span id="cb35-14"><a href="week-6---harvesting-and-bifurcation.html#cb35-14" tabindex="-1"></a>state <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">N =</span> <span class="dv">10</span>)</span>
<span id="cb35-15"><a href="week-6---harvesting-and-bifurcation.html#cb35-15" tabindex="-1"></a></span>
<span id="cb35-16"><a href="week-6---harvesting-and-bifurcation.html#cb35-16" tabindex="-1"></a><span class="do">#### Bifurcation diagram for H -- the forward branch</span></span>
<span id="cb35-17"><a href="week-6---harvesting-and-bifurcation.html#cb35-17" tabindex="-1"></a><span class="do">## Set first forward simulation and saving space</span></span>
<span id="cb35-18"><a href="week-6---harvesting-and-bifurcation.html#cb35-18" tabindex="-1"></a>H.vec.forward <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.001</span>, <span class="fl">0.25</span>, <span class="at">by =</span> <span class="fl">0.001</span>)</span>
<span id="cb35-19"><a href="week-6---harvesting-and-bifurcation.html#cb35-19" tabindex="-1"></a>parms <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">r =</span> <span class="fl">0.055</span>, <span class="at">K =</span> <span class="dv">10</span>, <span class="at">H =</span> H.vec.forward[<span class="dv">1</span>], <span class="at">A =</span> <span class="dv">1</span>)</span>
<span id="cb35-20"><a href="week-6---harvesting-and-bifurcation.html#cb35-20" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="fu">ode</span>(<span class="at">func =</span> BudwormODE, <span class="at">times =</span> times, <span class="at">y =</span> state, <span class="at">parms =</span> parms)</span>
<span id="cb35-21"><a href="week-6---harvesting-and-bifurcation.html#cb35-21" tabindex="-1"></a>forward <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">H =</span> H.vec.forward,</span>
<span id="cb35-22"><a href="week-6---harvesting-and-bifurcation.html#cb35-22" tabindex="-1"></a>                      <span class="at">N =</span> <span class="fu">rep</span>(temp[<span class="fu">length</span>(times), <span class="dv">2</span>], <span class="fu">length</span>(H.vec.forward)))</span>
<span id="cb35-23"><a href="week-6---harvesting-and-bifurcation.html#cb35-23" tabindex="-1"></a><span class="do">## Run across forward vector, using previous step equilibrium as new initial state</span></span>
<span id="cb35-24"><a href="week-6---harvesting-and-bifurcation.html#cb35-24" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(H.vec.forward)){</span>
<span id="cb35-25"><a href="week-6---harvesting-and-bifurcation.html#cb35-25" tabindex="-1"></a>  state <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">N =</span> forward[i<span class="dv">-1</span>, <span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.001</span>) <span class="do">## Remember to add small perturbation</span></span>
<span id="cb35-26"><a href="week-6---harvesting-and-bifurcation.html#cb35-26" tabindex="-1"></a>  parms <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">r =</span> <span class="fl">0.055</span>, <span class="at">K =</span> <span class="dv">10</span>, <span class="at">H =</span> forward[i, <span class="dv">1</span>], <span class="at">A =</span> <span class="dv">1</span>)</span>
<span id="cb35-27"><a href="week-6---harvesting-and-bifurcation.html#cb35-27" tabindex="-1"></a>  temp <span class="ot">&lt;-</span> <span class="fu">ode</span>(<span class="at">func =</span> BudwormODE, <span class="at">times =</span> times, <span class="at">y =</span> state, <span class="at">parms =</span> parms)</span>
<span id="cb35-28"><a href="week-6---harvesting-and-bifurcation.html#cb35-28" tabindex="-1"></a>  forward[i, <span class="dv">2</span>] <span class="ot">=</span> temp[<span class="fu">length</span>(times), <span class="dv">2</span>]</span>
<span id="cb35-29"><a href="week-6---harvesting-and-bifurcation.html#cb35-29" tabindex="-1"></a>}</span>
<span id="cb35-30"><a href="week-6---harvesting-and-bifurcation.html#cb35-30" tabindex="-1"></a><span class="do">#### Bifurcation diagram for H -- the backward branch</span></span>
<span id="cb35-31"><a href="week-6---harvesting-and-bifurcation.html#cb35-31" tabindex="-1"></a><span class="do">## Set first backward simulation and saving space</span></span>
<span id="cb35-32"><a href="week-6---harvesting-and-bifurcation.html#cb35-32" tabindex="-1"></a>H.vec.backward <span class="ot">&lt;-</span> <span class="fu">rev</span>(H.vec.forward)</span>
<span id="cb35-33"><a href="week-6---harvesting-and-bifurcation.html#cb35-33" tabindex="-1"></a>parms <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">r =</span> <span class="fl">0.055</span>, <span class="at">K =</span> <span class="dv">10</span>, <span class="at">H =</span> H.vec.backward[<span class="dv">1</span>], <span class="at">A =</span> <span class="dv">1</span>)</span>
<span id="cb35-34"><a href="week-6---harvesting-and-bifurcation.html#cb35-34" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="fu">ode</span>(<span class="at">func =</span> BudwormODE, <span class="at">times =</span> times, <span class="at">y =</span> state, <span class="at">parms =</span> parms)</span>
<span id="cb35-35"><a href="week-6---harvesting-and-bifurcation.html#cb35-35" tabindex="-1"></a>backward <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">H =</span> H.vec.backward,</span>
<span id="cb35-36"><a href="week-6---harvesting-and-bifurcation.html#cb35-36" tabindex="-1"></a>                       <span class="at">N =</span> <span class="fu">rep</span>(temp[<span class="fu">length</span>(times), <span class="dv">2</span>], <span class="fu">length</span>(H.vec.backward)))</span>
<span id="cb35-37"><a href="week-6---harvesting-and-bifurcation.html#cb35-37" tabindex="-1"></a><span class="do">## Run across backward vector, using previous step equilibrium as new initial state</span></span>
<span id="cb35-38"><a href="week-6---harvesting-and-bifurcation.html#cb35-38" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(H.vec.backward)){</span>
<span id="cb35-39"><a href="week-6---harvesting-and-bifurcation.html#cb35-39" tabindex="-1"></a>  state <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">N =</span> backward[i<span class="dv">-1</span>, <span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.001</span>)  <span class="do">## Remember to add small perturbation</span></span>
<span id="cb35-40"><a href="week-6---harvesting-and-bifurcation.html#cb35-40" tabindex="-1"></a>  parms <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">r =</span> <span class="fl">0.055</span>, <span class="at">K =</span> <span class="dv">10</span>, <span class="at">H =</span> backward[i, <span class="dv">1</span>], <span class="at">A =</span> <span class="dv">1</span>)</span>
<span id="cb35-41"><a href="week-6---harvesting-and-bifurcation.html#cb35-41" tabindex="-1"></a>  temp <span class="ot">&lt;-</span> <span class="fu">ode</span>(<span class="at">func =</span> BudwormODE, <span class="at">times =</span> times, <span class="at">y =</span> state, <span class="at">parms =</span> parms)</span>
<span id="cb35-42"><a href="week-6---harvesting-and-bifurcation.html#cb35-42" tabindex="-1"></a>  backward[i, <span class="dv">2</span>] <span class="ot">=</span> temp[<span class="fu">length</span>(times), <span class="dv">2</span>]</span>
<span id="cb35-43"><a href="week-6---harvesting-and-bifurcation.html#cb35-43" tabindex="-1"></a>}</span>
<span id="cb35-44"><a href="week-6---harvesting-and-bifurcation.html#cb35-44" tabindex="-1"></a></span>
<span id="cb35-45"><a href="week-6---harvesting-and-bifurcation.html#cb35-45" tabindex="-1"></a><span class="do">#### Plot both forward and backward branch</span></span>
<span id="cb35-46"><a href="week-6---harvesting-and-bifurcation.html#cb35-46" tabindex="-1"></a><span class="fu">plot</span>(forward[, <span class="dv">1</span>], forward[, <span class="dv">2</span>],</span>
<span id="cb35-47"><a href="week-6---harvesting-and-bifurcation.html#cb35-47" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">range</span>(H.vec.forward), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="at">las =</span> <span class="dv">1</span>, <span class="at">pch =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="at">cex =</span> <span class="fl">1.6</span>,</span>
<span id="cb35-48"><a href="week-6---harvesting-and-bifurcation.html#cb35-48" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;H&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Equilibrium density, N*&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Budworm model bifurcation along H&quot;</span>)</span>
<span id="cb35-49"><a href="week-6---harvesting-and-bifurcation.html#cb35-49" tabindex="-1"></a><span class="fu">points</span>(backward[, <span class="dv">1</span>], backward[, <span class="dv">2</span>], <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">&quot;lightblue&quot;</span>)</span>
<span id="cb35-50"><a href="week-6---harvesting-and-bifurcation.html#cb35-50" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">16</span>), <span class="at">pt.cex =</span> <span class="fl">1.5</span>, <span class="fu">c</span>(<span class="st">&quot;forward&quot;</span>, <span class="st">&quot;backward&quot;</span>),</span>
<span id="cb35-51"><a href="week-6---harvesting-and-bifurcation.html#cb35-51" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;darkblue&quot;</span>, <span class="st">&quot;lightblue&quot;</span>))</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-27-1.png" width="672" />
<br></p>
<!-- **Part 2 - Non-dimensionalized model, a 2-D bifurcation diagram** -->
<!-- <br> -->
<!-- Third, we will plot a 2-D bifurcation diagram, with $r$ against $K$,  -->
<!-- \[ -->
<!-- \dfrac{dN}{dt} = rx(1 - \dfrac{x}{K}) - \dfrac{x^2}{1 + x^2}, -->
<!-- \] -->
<!-- \[ -->
<!-- r = \dfrac{2x^3}{(1 + x^2)^2}, K = \dfrac{2x^3}{(x^2 - 1)} -->
<!-- \] -->
<!-- ```{r} -->
<!-- #### 2-D bifurcation diagram following analytical solution from Strogatz -->
<!-- #### For nondimensionalized model dx/du = rx(1-x/k) - x^2/(1+x^2) -->
<!-- #### There exist parametric curves for bifurcation points r(x) and k(x) -->
<!-- x.bifur = seq(1.001, 50, by = 0.001) -->
<!-- bifur2D = data.frame(x.bifur = x.bifur,  -->
<!--                      r.bifur = 2 * x.bifur^3 / ((1 + x.bifur^2)^2), -->
<!--                      k.bifur = 2 * x.bifur^3 / (x.bifur^2 - 1)) -->
<!-- plot(r.bifur ~ k.bifur, bifur2D, type = "l", lwd = 2, las = 1,  -->
<!--      xlim = c(0, 60), ylim = c(0, max(bifur2D$r.bifur) * 1.1),  -->
<!--      xlab = "K", ylab = "r", main = "Budworm model bifurcation along r-k space") -->
<!-- ``` -->
<!-- <br> -->

</div>
            </section>

          </div>
        </div>
      </div>
<a href="week-5---metapopulations-and-patch-occupancy-models.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="week-7---age-structure-population-model.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/ChingLinHuang/2022_Fall_TheoEcol/05_Week_5.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
