<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Week 7 - Age-structure population model | Introduction to Theoretical Ecology</title>
  <meta name="description" content="This is the course website for Introduction to Theoretical Ecology 2024 Fall at National Taiwan University." />
  <meta name="generator" content="bookdown 0.39 and GitBook 2.6.7" />

  <meta property="og:title" content="Week 7 - Age-structure population model | Introduction to Theoretical Ecology" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://pojuke.github.io/TheoreticalEcologyPJK/bifurcation.gif" />
  <meta property="og:description" content="This is the course website for Introduction to Theoretical Ecology 2024 Fall at National Taiwan University." />
  <meta name="github-repo" content="pojuke/TheoreticalEcologyPJK" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Week 7 - Age-structure population model | Introduction to Theoretical Ecology" />
  
  <meta name="twitter:description" content="This is the course website for Introduction to Theoretical Ecology 2024 Fall at National Taiwan University." />
  <meta name="twitter:image" content="https://pojuke.github.io/TheoreticalEcologyPJK/bifurcation.gif" />

<meta name="author" content="Instructor: Po-Ju Ke ~~~~~ Teaching Assistant: Hsiang-Chih Lo" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="week-6---harvesting-and-bifurcation.html"/>
<link rel="next" href="week-8---lotka-volterra-competition-model---population-dynamics.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Introduction to Theoretical Ecology</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Course information</a></li>
<li class="chapter" data-level="" data-path="syllabus.html"><a href="syllabus.html"><i class="fa fa-check"></i>Syllabus</a></li>
<li class="chapter" data-level="" data-path="week-2---exponential-population-growth.html"><a href="week-2---exponential-population-growth.html"><i class="fa fa-check"></i>Week 2 - Exponential population growth</a></li>
<li class="chapter" data-level="" data-path="week-3---national-holiday-no-class.html"><a href="week-3---national-holiday-no-class.html"><i class="fa fa-check"></i>Week 3 - National holiday (No class)</a></li>
<li class="chapter" data-level="" data-path="week-4---logistic-population-growth-and-stability-analysis.html"><a href="week-4---logistic-population-growth-and-stability-analysis.html"><i class="fa fa-check"></i>Week 4 - Logistic population growth and stability analysis</a></li>
<li class="chapter" data-level="" data-path="week-5---metapopulations-and-patch-occupancy-models.html"><a href="week-5---metapopulations-and-patch-occupancy-models.html"><i class="fa fa-check"></i>Week 5 - Metapopulations and patch occupancy models</a></li>
<li class="chapter" data-level="" data-path="week-6---harvesting-and-bifurcation.html"><a href="week-6---harvesting-and-bifurcation.html"><i class="fa fa-check"></i>Week 6 - Harvesting and bifurcation</a></li>
<li class="chapter" data-level="" data-path="week-7---age-structure-population-model.html"><a href="week-7---age-structure-population-model.html"><i class="fa fa-check"></i>Week 7 - Age-structure population model</a></li>
<li class="chapter" data-level="" data-path="week-8---lotka-volterra-competition-model---population-dynamics.html"><a href="week-8---lotka-volterra-competition-model---population-dynamics.html"><i class="fa fa-check"></i>Week 8 - Lotka-Volterra competition model - Population dynamics</a></li>
<li class="chapter" data-level="" data-path="week-9---midterm.html"><a href="week-9---midterm.html"><i class="fa fa-check"></i>Week 9 - Midterm</a></li>
<li class="chapter" data-level="" data-path="week-10---lotka-volterra-competition-model---visualization-of-dynamics-with-complex-eigenvalues.html"><a href="week-10---lotka-volterra-competition-model---visualization-of-dynamics-with-complex-eigenvalues.html"><i class="fa fa-check"></i>Week 10 - Lotka-Volterra competition model - Visualization of dynamics with complex eigenvalues</a></li>
<li class="chapter" data-level="" data-path="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html"><a href="week-11---lotka-volterra-model-of-predator-prey-interactions-and-time-scale-separation.html"><i class="fa fa-check"></i>Week 11 - Lotka-Volterra model of predator-prey interactions and time-scale separation</a></li>
<li class="chapter" data-level="" data-path="week-12---rosenzweig-macarthur-predator-prey-model-and-mays-complexity-stability-relationship.html"><a href="week-12---rosenzweig-macarthur-predator-prey-model-and-mays-complexity-stability-relationship.html"><i class="fa fa-check"></i>Week 12 - Rosenzweig-MacArthur predator-prey model and Mayâ€™s complexity-stability relationship</a></li>
<li class="chapter" data-level="" data-path="week-13---parameter-space-for-apparent-competition-model.html"><a href="week-13---parameter-space-for-apparent-competition-model.html"><i class="fa fa-check"></i>Week 13 - Parameter space for apparent competition model</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to Theoretical Ecology</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="week-7---age-structure-population-model" class="section level1 unnumbered hasAnchor">
<h1>Week 7 - Age-structure population model<a href="week-7---age-structure-population-model.html#week-7---age-structure-population-model" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this lab section, we will analyze a Leslie matrix using <code>for</code> loops and matrix algebra, compare the results with those obtained via eigen-analysis, and visualize the population dynamics and age distribution.</p>
<p><strong>Part 1 - Visualizing stable age distribution</strong></p>
<p>For any diagonalizable n-by-n matrix <span class="math inline">\(M\)</span> with only one dominant eigenvalue, and for any n-by-1 vector <span class="math inline">\(v\)</span>, <span class="math inline">\(M^tv\)</span> will shift to the same direction with the eigenvector of <span class="math inline">\(M\)</span> corresponding to the dominant eigenvalue when <span class="math inline">\(t\)</span> is large. Here, we visualize this fact numerically.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="week-7---age-structure-population-model.html#cb36-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb36-2"><a href="week-7---age-structure-population-model.html#cb36-2" tabindex="-1"></a>Time <span class="ot">=</span> <span class="dv">6</span></span>
<span id="cb36-3"><a href="week-7---age-structure-population-model.html#cb36-3" tabindex="-1"></a>A <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">0.5</span>, <span class="dv">0</span>), <span class="dv">2</span>, <span class="dv">2</span>, <span class="at">byrow=</span>T)</span>
<span id="cb36-4"><a href="week-7---age-structure-population-model.html#cb36-4" tabindex="-1"></a>N <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>, Time, <span class="dv">2</span>)</span>
<span id="cb36-5"><a href="week-7---age-structure-population-model.html#cb36-5" tabindex="-1"></a>N[<span class="dv">1</span>, ] <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb36-6"><a href="week-7---age-structure-population-model.html#cb36-6" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>Time){</span>
<span id="cb36-7"><a href="week-7---age-structure-population-model.html#cb36-7" tabindex="-1"></a>  N[i, ] <span class="ot">=</span> A <span class="sc">%*%</span> N[i<span class="dv">-1</span>, ]</span>
<span id="cb36-8"><a href="week-7---age-structure-population-model.html#cb36-8" tabindex="-1"></a>}</span>
<span id="cb36-9"><a href="week-7---age-structure-population-model.html#cb36-9" tabindex="-1"></a>Data <span class="ot">=</span> <span class="fu">as.data.frame</span>(N)</span>
<span id="cb36-10"><a href="week-7---age-structure-population-model.html#cb36-10" tabindex="-1"></a>Data<span class="sc">$</span>Time <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>Time)</span>
<span id="cb36-11"><a href="week-7---age-structure-population-model.html#cb36-11" tabindex="-1"></a>Data<span class="sc">$</span>V1.start <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb36-12"><a href="week-7---age-structure-population-model.html#cb36-12" tabindex="-1"></a>Data<span class="sc">$</span>V2.start <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb36-13"><a href="week-7---age-structure-population-model.html#cb36-13" tabindex="-1"></a></span>
<span id="cb36-14"><a href="week-7---age-structure-population-model.html#cb36-14" tabindex="-1"></a><span class="fu">ggplot</span>(Data, <span class="fu">aes</span>(<span class="at">x=</span>V1, <span class="at">y=</span>V2, <span class="at">col=</span><span class="fu">as.factor</span>(Time))) <span class="sc">+</span> </span>
<span id="cb36-15"><a href="week-7---age-structure-population-model.html#cb36-15" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb36-16"><a href="week-7---age-structure-population-model.html#cb36-16" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x=</span>V1.start, <span class="at">y=</span>V2.start, <span class="at">xend=</span>V1, <span class="at">yend=</span>V2), </span>
<span id="cb36-17"><a href="week-7---age-structure-population-model.html#cb36-17" tabindex="-1"></a>               <span class="at">arrow=</span><span class="fu">arrow</span>(<span class="at">type=</span><span class="st">&quot;closed&quot;</span>, <span class="at">length=</span><span class="fu">unit</span>(<span class="fl">0.4</span>,<span class="st">&quot;cm&quot;</span>))) <span class="sc">+</span> </span>
<span id="cb36-18"><a href="week-7---age-structure-population-model.html#cb36-18" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x=</span>V1<span class="fl">+0.1</span>, <span class="at">y=</span>V2<span class="fl">+0.1</span>, <span class="at">label=</span>Time)) <span class="sc">+</span> </span>
<span id="cb36-19"><a href="week-7---age-structure-population-model.html#cb36-19" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="st">&quot;Time&quot;</span>, <span class="at">type=</span><span class="st">&quot;qual&quot;</span>, <span class="at">palette=</span><span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb36-20"><a href="week-7---age-structure-population-model.html#cb36-20" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Age 1&quot;</span>, <span class="at">y=</span><span class="st">&quot;Age 2&quot;</span>) <span class="sc">+</span>  </span>
<span id="cb36-21"><a href="week-7---age-structure-population-model.html#cb36-21" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
<!-- library(ggplot2) -->
<!-- set.seed(1234) -->
<!-- MAT <- matrix(rnorm(25), ncol = 5, nrow = 5) -->
<!-- abs(eigen(MAT)$values) # check only one dominant eigenvalue -->
<!-- eig_vec1 <- as.numeric(eigen(MAT)$vector[, 1]) -->
<!-- v <- rnorm(5) -->
<!-- time <- 15 -->
<!-- dat_v <- data.frame(matrix(ncol = 5, nrow = time)) -->
<!-- dat_v[1, ] <- v -->
<!-- for(i in 2:time){ -->
<!--   dat_v[i, ] <- MAT %*% t(dat_v[i-1, ]) -->
<!-- } -->
<!-- # Remake data for gganimate -->
<!-- dat <- data.frame(X1 = 0, X2 = 0, Time = 1) -->
<!-- for(i in 1:time){ -->
<!--   dat <- rbind(dat, data.frame(dat_v[i,1:2] / sqrt(sum(dat_v[i,1:2]^2)) * i, Time = i)) -->
<!--   dat <- rbind(dat, c(0,0, i+1)) -->
<!-- } -->
<!-- dat <- dat[-nrow(dat), ] -->
<!-- ggplot(dat, aes(X1, X2, color = Time)) + -->
<!--   geom_path(arrow = arrow(length = unit(0.55, "cm"))) +  -->
<!--   geom_abline(intercept = 0,  -->
<!--               slope = eig_vec1[2]/eig_vec1[1],  -->
<!--               color = "red",  -->
<!--               linetype = "dashed") # red dashed eigenvector -->
<p><br></p>
<p><strong>Part 2 - Analyzing Leslie matrix</strong></p>
<p>Consider an age-strutured population model
<span class="math display">\[
n_{t} = L^tn_0
\]</span>
where <span class="math inline">\(L\)</span> is a Leslie matrix and <span class="math inline">\(n_t = (n_{1,t}, n_{2,t}, n_{3,t})\)</span> is the population sizes with three different ages in time <span class="math inline">\(t\)</span>.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="week-7---age-structure-population-model.html#cb37-1" tabindex="-1"></a><span class="do">### Leslie matrix and initial age classes</span></span>
<span id="cb37-2"><a href="week-7---age-structure-population-model.html#cb37-2" tabindex="-1"></a>leslie <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">5</span>,</span>
<span id="cb37-3"><a href="week-7---age-structure-population-model.html#cb37-3" tabindex="-1"></a>                          <span class="fl">0.5</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb37-4"><a href="week-7---age-structure-population-model.html#cb37-4" tabindex="-1"></a>                          <span class="dv">0</span>, <span class="fl">0.3</span>, <span class="dv">0</span>),</span>
<span id="cb37-5"><a href="week-7---age-structure-population-model.html#cb37-5" tabindex="-1"></a>                      <span class="at">nrow =</span> <span class="dv">3</span>,</span>
<span id="cb37-6"><a href="week-7---age-structure-population-model.html#cb37-6" tabindex="-1"></a>                      <span class="at">ncol =</span> <span class="dv">3</span>,</span>
<span id="cb37-7"><a href="week-7---age-structure-population-model.html#cb37-7" tabindex="-1"></a>                      <span class="at">byrow =</span> T)</span>
<span id="cb37-8"><a href="week-7---age-structure-population-model.html#cb37-8" tabindex="-1"></a></span>
<span id="cb37-9"><a href="week-7---age-structure-population-model.html#cb37-9" tabindex="-1"></a>N0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb37-10"><a href="week-7---age-structure-population-model.html#cb37-10" tabindex="-1"></a></span>
<span id="cb37-11"><a href="week-7---age-structure-population-model.html#cb37-11" tabindex="-1"></a><span class="do">### for loop and matrix algebra</span></span>
<span id="cb37-12"><a href="week-7---age-structure-population-model.html#cb37-12" tabindex="-1"></a>time <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb37-13"><a href="week-7---age-structure-population-model.html#cb37-13" tabindex="-1"></a>pop_size <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Age1 =</span> <span class="fu">rep</span>(<span class="dv">0</span>, time),</span>
<span id="cb37-14"><a href="week-7---age-structure-population-model.html#cb37-14" tabindex="-1"></a>                       <span class="at">Age2 =</span> <span class="fu">rep</span>(<span class="dv">0</span>, time),</span>
<span id="cb37-15"><a href="week-7---age-structure-population-model.html#cb37-15" tabindex="-1"></a>                       <span class="at">Age3 =</span> <span class="fu">rep</span>(<span class="dv">0</span>, time))</span>
<span id="cb37-16"><a href="week-7---age-structure-population-model.html#cb37-16" tabindex="-1"></a>pop_size[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> N0</span>
<span id="cb37-17"><a href="week-7---age-structure-population-model.html#cb37-17" tabindex="-1"></a></span>
<span id="cb37-18"><a href="week-7---age-structure-population-model.html#cb37-18" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>time) {</span>
<span id="cb37-19"><a href="week-7---age-structure-population-model.html#cb37-19" tabindex="-1"></a>  <span class="co"># Matrix multiplication</span></span>
<span id="cb37-20"><a href="week-7---age-structure-population-model.html#cb37-20" tabindex="-1"></a>  pop_size[i, ] <span class="ot">&lt;-</span> leslie <span class="sc">%*%</span> <span class="fu">t</span>(pop_size[i<span class="dv">-1</span>, ])</span>
<span id="cb37-21"><a href="week-7---age-structure-population-model.html#cb37-21" tabindex="-1"></a>}</span>
<span id="cb37-22"><a href="week-7---age-structure-population-model.html#cb37-22" tabindex="-1"></a></span>
<span id="cb37-23"><a href="week-7---age-structure-population-model.html#cb37-23" tabindex="-1"></a><span class="co"># Total abundance</span></span>
<span id="cb37-24"><a href="week-7---age-structure-population-model.html#cb37-24" tabindex="-1"></a>pop_size<span class="sc">$</span>N <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(pop_size)</span>
<span id="cb37-25"><a href="week-7---age-structure-population-model.html#cb37-25" tabindex="-1"></a></span>
<span id="cb37-26"><a href="week-7---age-structure-population-model.html#cb37-26" tabindex="-1"></a><span class="fu">head</span>(pop_size)</span></code></pre></div>
<pre><code>##   Age1 Age2  Age3      N
## 1 10.0 0.00 0.000 10.000
## 2  0.0 5.00 0.000  5.000
## 3  5.0 0.00 1.500  6.500
## 4  7.5 2.50 0.000 10.000
## 5  2.5 3.75 0.750  7.000
## 6  7.5 1.25 1.125  9.875</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="week-7---age-structure-population-model.html#cb39-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">c</span>(<span class="dv">1</span>,time), <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">265</span>), <span class="at">type =</span> <span class="st">&quot;n&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;time&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;pop_size&quot;</span>)</span>
<span id="cb39-2"><a href="week-7---age-structure-population-model.html#cb39-2" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span>time , pop_size<span class="sc">$</span>Age1, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb39-3"><a href="week-7---age-structure-population-model.html#cb39-3" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span>time , pop_size<span class="sc">$</span>Age2, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb39-4"><a href="week-7---age-structure-population-model.html#cb39-4" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span>time , pop_size<span class="sc">$</span>Age3, <span class="at">col =</span> <span class="st">&quot;green&quot;</span>)</span>
<span id="cb39-5"><a href="week-7---age-structure-population-model.html#cb39-5" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,</span>
<span id="cb39-6"><a href="week-7---age-structure-population-model.html#cb39-6" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Age1&quot;</span>, <span class="st">&quot;Age2&quot;</span>, <span class="st">&quot;Age3&quot;</span>),</span>
<span id="cb39-7"><a href="week-7---age-structure-population-model.html#cb39-7" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;green&quot;</span>),</span>
<span id="cb39-8"><a href="week-7---age-structure-population-model.html#cb39-8" tabindex="-1"></a>       <span class="at">lty =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
<p>Plot in log-scale:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="week-7---age-structure-population-model.html#cb40-1" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span>time, <span class="at">y =</span> <span class="fu">log</span>(pop_size[, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]), <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">lty =</span> <span class="dv">1</span>,</span>
<span id="cb40-2"><a href="week-7---age-structure-population-model.html#cb40-2" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;black&quot;</span>),</span>
<span id="cb40-3"><a href="week-7---age-structure-population-model.html#cb40-3" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">&quot;Time&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;log(population size)&quot;</span>)</span>
<span id="cb40-4"><a href="week-7---age-structure-population-model.html#cb40-4" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;Age 1&quot;</span>, <span class="st">&quot;Age 2&quot;</span>, <span class="st">&quot;Age 3&quot;</span>, <span class="st">&quot;Total&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb40-5"><a href="week-7---age-structure-population-model.html#cb40-5" tabindex="-1"></a>       <span class="at">lty =</span> <span class="dv">1</span> , <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;black&quot;</span>))</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
<p>By the derivation in the class, the asymptotic population sizes can be approximated by
<span class="math display">\[
n_t \approx c\cdot \lambda_1^t\cdot u_1
\]</span>
where <span class="math inline">\(c\)</span> is a constant, <span class="math inline">\(\lambda_1\)</span> is the dominant eigenvalue and <span class="math inline">\(u_1\)</span> is the corresponding eigenvector. Hence, with the long-term dynamics, the population grows at a rate <span class="math inline">\(\lambda_1\)</span> and with the age distribution <span class="math inline">\(u_1\)</span>. Here, we check this fact numerically.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="week-7---age-structure-population-model.html#cb41-1" tabindex="-1"></a><span class="do">### Asymptotic growth rate and stable age distribution</span></span>
<span id="cb41-2"><a href="week-7---age-structure-population-model.html#cb41-2" tabindex="-1"></a></span>
<span id="cb41-3"><a href="week-7---age-structure-population-model.html#cb41-3" tabindex="-1"></a>asymptotic_growth <span class="ot">&lt;-</span> pop_size<span class="sc">$</span>N[time]<span class="sc">/</span>pop_size<span class="sc">$</span>N[time<span class="dv">-1</span>]</span>
<span id="cb41-4"><a href="week-7---age-structure-population-model.html#cb41-4" tabindex="-1"></a>asymptotic_growth</span></code></pre></div>
<pre><code>## [1] 1.089992</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="week-7---age-structure-population-model.html#cb43-1" tabindex="-1"></a>age_distribution <span class="ot">&lt;-</span> pop_size[time, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]<span class="sc">/</span><span class="fu">sum</span>(pop_size[time, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb43-2"><a href="week-7---age-structure-population-model.html#cb43-2" tabindex="-1"></a>age_distribution</span></code></pre></div>
<pre><code>##         Age1      Age2       Age3
## 50 0.6309262 0.2894167 0.07965713</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="week-7---age-structure-population-model.html#cb45-1" tabindex="-1"></a><span class="do">### Eigen-analysis of the Leslie matrix</span></span>
<span id="cb45-2"><a href="week-7---age-structure-population-model.html#cb45-2" tabindex="-1"></a>EIGEN <span class="ot">&lt;-</span> <span class="fu">eigen</span>(leslie)</span>
<span id="cb45-3"><a href="week-7---age-structure-population-model.html#cb45-3" tabindex="-1"></a>EIGEN</span></code></pre></div>
<pre><code>## eigen() decomposition
## $values
## [1]  1.0899905+0.0000000i -0.5449953+0.6253475i -0.5449953-0.6253475i
## 
## $vectors
##              [,1]                  [,2]                  [,3]
## [1,] 0.9030054+0i -0.8418972+0.0000000i -0.8418972+0.0000000i
## [2,] 0.4142263+0i  0.3334136+0.3825709i  0.3334136-0.3825709i
## [3,] 0.1140082+0i  0.0250833-0.1818099i  0.0250833+0.1818099i</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="week-7---age-structure-population-model.html#cb47-1" tabindex="-1"></a><span class="fu">abs</span>(EIGEN<span class="sc">$</span>values[<span class="dv">1</span>]) <span class="co"># dominant eigenvalue</span></span></code></pre></div>
<pre><code>## [1] 1.089991</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="week-7---age-structure-population-model.html#cb49-1" tabindex="-1"></a><span class="fu">as.numeric</span>(EIGEN<span class="sc">$</span>vectors[, <span class="dv">1</span>] <span class="sc">/</span> <span class="fu">sum</span>(EIGEN<span class="sc">$</span>vectors[, <span class="dv">1</span>])) <span class="co"># corresponding eigenvector</span></span></code></pre></div>
<pre><code>## [1] 0.63092527 0.28941777 0.07965696</code></pre>
<p>The asymptotic growth rate and stable age distribution obtained from for loops and eigen-analysis are similar.</p>
<p><br></p>
<p><strong>Part 3 - In-class exercise: Analyzing population matrix of common teasel</strong></p>
<p><a href="https://en.wikipedia.org/wiki/Dipsacus_fullonum">Common teasel (<em>Dipsacus sylvestris</em>)</a> is a herbaceous plant commonly found in abandoned fields and meadows in North America. It has a complex life cycle consisting of various stages. The seeds may lie dormant for one or two years. Seeds that germinate form small rosettes, which will gradually transit into medium and eventually large rosettes. These rosettes (all three sizes) may remain in the same stage for years before entering the next stage. After undergoing vernalization, large (and a few medium) rosettes will form stalks and flower in the upcoming summer, set seeds once, and die. Occasionally, the flowering plants will produce seeds that directly germinate into small/medium/large rosettes without entering dormancy.</p>
<p>Here is a transition diagram for the teasel. Please convert this diagram into a stage-based transition matrix (Lefkovitch matrix) and derive the asymptotic growth rate <span class="math inline">\(\lambda\)</span> in R.</p>
<p><img src="Teasel%20Diagram.png" width= "100%"/></p>
<p><br></p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="week-7---age-structure-population-model.html#cb51-1" tabindex="-1"></a><span class="do">### Leslie matrix for Teasel</span></span>
<span id="cb51-2"><a href="week-7---age-structure-population-model.html#cb51-2" tabindex="-1"></a>Teasel <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data =</span> <span class="fu">c</span>(<span class="dv">0</span>,      <span class="dv">0</span>,      <span class="dv">0</span>,      <span class="dv">0</span>,      <span class="dv">0</span>,      <span class="fl">322.38</span>,</span>
<span id="cb51-3"><a href="week-7---age-structure-population-model.html#cb51-3" tabindex="-1"></a>                          <span class="fl">0.966</span>,  <span class="dv">0</span>,      <span class="dv">0</span>,      <span class="dv">0</span>,      <span class="dv">0</span>,      <span class="dv">0</span>,</span>
<span id="cb51-4"><a href="week-7---age-structure-population-model.html#cb51-4" tabindex="-1"></a>                          <span class="fl">0.013</span>,  <span class="fl">0.010</span>,  <span class="fl">0.125</span>,  <span class="dv">0</span>,      <span class="dv">0</span>,      <span class="fl">3.448</span>,</span>
<span id="cb51-5"><a href="week-7---age-structure-population-model.html#cb51-5" tabindex="-1"></a>                          <span class="fl">0.007</span>,  <span class="dv">0</span>,      <span class="fl">0.125</span>,  <span class="fl">0.238</span>,  <span class="dv">0</span>,      <span class="fl">30.17</span>,</span>
<span id="cb51-6"><a href="week-7---age-structure-population-model.html#cb51-6" tabindex="-1"></a>                          <span class="fl">0.008</span>,  <span class="dv">0</span>,      <span class="dv">0</span>,      <span class="fl">0.245</span>,  <span class="fl">0.167</span>,  <span class="fl">0.862</span>,</span>
<span id="cb51-7"><a href="week-7---age-structure-population-model.html#cb51-7" tabindex="-1"></a>                          <span class="dv">0</span>,      <span class="dv">0</span>,      <span class="dv">0</span>,      <span class="fl">0.023</span>,  <span class="fl">0.75</span>,   <span class="dv">0</span>),</span>
<span id="cb51-8"><a href="week-7---age-structure-population-model.html#cb51-8" tabindex="-1"></a>                 <span class="at">nrow =</span> <span class="dv">6</span>,</span>
<span id="cb51-9"><a href="week-7---age-structure-population-model.html#cb51-9" tabindex="-1"></a>                 <span class="at">ncol =</span> <span class="dv">6</span>,</span>
<span id="cb51-10"><a href="week-7---age-structure-population-model.html#cb51-10" tabindex="-1"></a>                 <span class="at">byrow =</span> T)</span>
<span id="cb51-11"><a href="week-7---age-structure-population-model.html#cb51-11" tabindex="-1"></a><span class="do">### Use eigen() function</span></span>
<span id="cb51-12"><a href="week-7---age-structure-population-model.html#cb51-12" tabindex="-1"></a>EIGEN <span class="ot">&lt;-</span> <span class="fu">eigen</span>(Teasel)</span>
<span id="cb51-13"><a href="week-7---age-structure-population-model.html#cb51-13" tabindex="-1"></a><span class="do">### Dominant eigenvalue</span></span>
<span id="cb51-14"><a href="week-7---age-structure-population-model.html#cb51-14" tabindex="-1"></a><span class="fu">abs</span>(EIGEN<span class="sc">$</span>values[<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 2.32188</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="week-7---age-structure-population-model.html#cb53-1" tabindex="-1"></a><span class="do">### corresponding eigenvector</span></span>
<span id="cb53-2"><a href="week-7---age-structure-population-model.html#cb53-2" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">as.numeric</span>(EIGEN<span class="sc">$</span>vectors[, <span class="dv">1</span>] <span class="sc">/</span> <span class="fu">sum</span>(EIGEN<span class="sc">$</span>vectors[, <span class="dv">1</span>])), <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 0.637 0.265 0.012 0.069 0.012 0.005</code></pre>
<p><strong>Part 4 - COM(P)ADRE: A global database of population matrices</strong></p>
<p><a href="https://compadre-db.org/ExploreDatabase">COM(P)ADRE</a> is an online repository containing matrix population models on hundreds of plants, animals, algae, fungi, bacteria, and viruses around the world, as well as their associated metadata. Take a look at the website: You will be exploring the population dynamics of a species (of your choice) in your assignment!</p>
<p><br></p>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="week-6---harvesting-and-bifurcation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="week-8---lotka-volterra-competition-model---population-dynamics.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/ChingLinHuang/2022_Fall_TheoEcol/07_Week_7_age_afterclass.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
